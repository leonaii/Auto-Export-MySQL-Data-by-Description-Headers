# MySQL 表数据导出工具

一个简单易用的 GUI 工具，用于导出 MySQL 数据库表数据，支持使用字段描述作为 Excel 表头。

## 功能特点

- 🖥️ 图形化界面，操作简单直观
- 📊 导出数据为 Excel 格式（.xlsx）
- 📝 自动使用字段注释（COLUMN_COMMENT）作为表头
- 🔌 支持连接测试功能
- 💾 多配置管理，支持保存、切换、删除多个数据库配置
- 🔄 自动记忆上次使用的配置
- 🗃️ 智能获取数据库和表列表（3秒超时保护）
- 🎯 字段筛选功能，可选择需要导出的字段
- 🚀 异步执行，所有操作不阻塞界面，带进度条显示
- ⚡ 自动生成带时间戳的文件名
- 📦 支持打包成单文件 EXE，无需安装 Python
- ✅ 完善的错误处理和用户提示

## 安装步骤

### 1. 确保已安装 Python

需要 Python 3.7 或更高版本。检查版本：

```bash
python --version
```

### 2. 安装依赖

在项目目录下运行：

```bash
pip install -r requirements.txt
```

依赖包括：
- `pymysql` - MySQL 数据库连接
- `pandas` - 数据处理
- `openpyxl` - Excel 文件生成

## 打包成 EXE（可选）

如果需要在没有 Python 环境的电脑上使用，可以打包成 EXE：

### 方法一：使用 PowerShell 脚本（推荐）

```powershell
# 直接双击运行
.\build.ps1

# 或者在 PowerShell 中执行
powershell -ExecutionPolicy Bypass -File build.ps1
```

### 方法二：手动打包

```bash
# 1. 安装 PyInstaller
pip install pyinstaller

# 2. 执行打包命令
pyinstaller --onefile --windowed --name=MySQLExporter main.py

# 3. 打包完成后，EXE 文件位于 dist 目录
```

详细打包说明请查看 [build_instructions.md](build_instructions.md)

## 使用说明

### 启动程序

```bash
python main.py
```

### 操作步骤

#### 1. 配置管理

**保存新配置**：
- 在"配置名称"框中输入名称（如"生产环境"、"测试环境"）
- 填写数据库连接信息
- 点击"保存配置"按钮

**加载已有配置**：
- 在"选择配置"下拉框中选择配置
- 点击"加载配置"按钮
- 配置信息会自动填充到表单

**删除配置**：
- 在"选择配置"下拉框中选择要删除的配置
- 点击"删除配置"按钮
- 确认删除

#### 2. 填写数据库配置

- 主机地址：MySQL 服务器地址（默认 localhost）
- 端口：MySQL 端口（默认 3306）
- 用户名：数据库用户名
- 密码：数据库密码
- 数据库名：可手动输入或点击"刷新"按钮自动获取
- 表名：可手动输入或点击"刷新"按钮自动获取

**智能获取功能**：
- 点击数据库名右侧的"刷新"按钮，程序会自动连接并获取所有可用数据库
- 点击表名右侧的"刷新"按钮，程序会自动获取选定数据库中的所有表
- 连接超时设置为3秒，超时后可手动输入
- 自动过滤系统数据库（information_schema、mysql等）

#### 3. 测试连接（可选）

- 点击"测试连接"按钮验证数据库配置是否正确
- 连接成功后会自动保存当前配置

#### 4. 选择字段（可选）

- 默认导出全部字段
- 点击"选择字段"按钮打开字段选择对话框
- 对话框显示所有字段的名称、类型和描述
- 勾选需要导出的字段（支持全选、反选）
- 点击"确定"保存选择，选中的字段会保存到配置中

**字段选择对话框**：
- ✓ 复选框：选择/取消字段
- 字段名：显示实际字段名（加粗）
- 类型：显示字段数据类型
- 描述：显示字段注释（如有）

#### 5. 导出数据

- 点击"导出数据"按钮
- 选择保存位置和文件名
- 等待导出完成
- 导出成功后会自动保存当前配置

### 表头说明

- 程序会自动读取表字段的注释（COLUMN_COMMENT）作为 Excel 表头
- 如果某个字段没有注释，则使用字段名作为表头
- 这样导出的 Excel 文件更易读，特别适合给非技术人员查看

## 示例

假设你有一个表结构：

```sql
CREATE TABLE users (
    id INT PRIMARY KEY COMMENT '用户ID',
    name VARCHAR(50) COMMENT '用户姓名',
    email VARCHAR(100) COMMENT '电子邮箱',
    created_at DATETIME COMMENT '创建时间'
);
```

导出的 Excel 文件表头将显示为：
- 用户ID
- 用户姓名
- 电子邮箱
- 创建时间

而不是：
- id
- name
- email
- created_at

## 注意事项

- 确保 MySQL 服务器允许远程连接（如果不是本地数据库）
- 确保数据库用户有 SELECT 权限
- 大表导出可能需要较长时间，请耐心等待
- 导出的文件名会自动添加时间戳，避免覆盖
- 配置信息保存在程序目录下的 `dby_config.json` 文件中（隐藏文件）
- 密码会以明文形式保存在配置文件中，请注意文件安全
- 程序会自动记忆上次使用的配置，下次启动时自动加载
- 刷新数据库/表列表时设置了3秒连接超时，超时后可手动输入
- 选择字段功能会保存到配置中，下次加载配置时自动恢复
- 如果未选择字段，默认导出全部字段

## 错误处理

程序包含以下错误处理：
- ❌ 连接失败提示
- ❌ 表不存在提示
- ❌ 输入验证
- ❌ 导出异常捕获
- ✅ 成功提示和数据行数统计

## 技术栈

- **GUI 框架**: Tkinter（Python 标准库）
- **数据库连接**: PyMySQL
- **数据处理**: Pandas
- **Excel 生成**: OpenPyXL
- **异步处理**: Threading（避免界面卡顿）
- **打包工具**: PyInstaller

## 许可证

本项目仅供学习和个人使用。
